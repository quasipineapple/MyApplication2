(276)1401000002000000C46EE60F46A02AFE49A5F4F61BFA907CA4AE993A6A0EC45EBDBEDAC54B3663ABF5C09521402B1E45EB24BC3B0621AC2850D4488161E6989296EE529D84EB828531A8621A103102A5BDD9FA2BAA1B316F3C12A4F7BC6DFFCA49BA0FB69B931ACC153694FAA2ED5E7273DE4011FF38E17D76C869E8A08C5B88BB3FE4CDF3AE7E1FE79FD62E6D01E3F566B58086951E26C07BBEB8997CE906F4230376071C882E800797731B6740B5C8D768179F13D1B4C5856B359A8C4D5D2DF1DCF78B584286B530927131E53F6AA8BBE9766D2D13F4469CFAB0A232F5CF285D1C3A02C00F78CF771E75BA1D568C36C28C5B53C1E6E9BDE47E4AEAB2F75F5F73968C3816B80C9BB4BBB95BD1233EF5E1D3031E
(116)7400000003000000C46EE60F46A02AFE70B5AB744802CCBD7F0B200AA93DBAF32D5667667A212F94DAFAB382BEBD7E2DEC5C369A67E11590CCD4D0535E1375F208AF099C2F556926AC1F943C6D11DA5194220B8E7C7E4389DF9B7CA3CA3E6C9A57C74DABC7F358EE07D852D6E18B313E2A4819ED


95.142.192.65 443
173.240.5.1:443
test 173.240.5.253:443


DataInputStream dis = new DataInputStream(new BufferedInputStream(socket.getInputStream()));

try {
   while(true) {
       listener.startOfMessage();
       for(int segSize; (segSize = dis.readInt()) > 0;) {
          byte[] bytes = new byte[segSize];
          dis.readFully(bytes);
          listener.data(bytes);
       }
       int footer = dis.read();
       // check footer ??
       listener.endOfMessage();
   }
} catch(EOFException endOfStream) {
   // handle or ignore
} finally {
   // close everything.
}


while ((read = reader.read(buffer)) >= 0 && thread == readerThread && !done){
                data = new byte[read];
                System.arraycopy(buffer, 0, data, 0, read);
                if(read > 0){
                    processPacket(PacketManager.parse(data));
                }
            }